/* === CSS CUSTOM PROPERTIES ===*/
:root {
  /* Layout */
  --gutter: 2rem;
  --max-width: 66rem;
  --breakpoint-single-column: 54rem; /* custom properties don't work in a media query, alas */

  /* Typography */
  --font-family: system-ui, sans-serif;
  --text-size: 16px;
  --line-height: 1.5;
  --font-size-xxs: 0.875rem;  --line-height-xxs: 1.715;
  --font-size-xs: 1rem; --line-height-xs: 1.5;
  --font-size-sm: 1.125rem; --line-height-sm: 1.3334;
  --font-size-md: 1.25rem; --line-height-md: 1.2;
  --font-size-lg: 1.5rem; --line-height-lg: 1;
  --font-size-xl: 2rem; --line-height-xl: 1;
  --font-size-2xl: 2.5rem; --line-height-2xl: 1.2;
  --font-size-3xl: 4rem; --line-height-3xl: 1;
  --line-height-tight: 1.1;

  /* Font weights */
  --font-weight-thin: 100;
  --font-weight-semibold: 600;
  --font-weight-bold: 700;
  --font-weight-black: 900;

  /* Letter spacing */
  --letter-spacing-tight: -0.025em;
  --letter-spacing-normal: normal;
  --letter-spacing-loose: 0.025em;

  /* Spacing */
  --spacing-xs: 0.5rem;
  --spacing-sm: 1rem;
  --spacing-md: 1.25rem;
  --spacing-lg: 2rem;
  --spacing-xl: 2.25rem;
  --spacing-ex: 5ex;

  /* Z-index */
  --z-index-skip-link: 100;

  /* Accessibility */
  --sr-only-offset: -9999rem;

  /* Colors - based on DR10 palette, adjusted for WCAG AA contrast */
  --text-color: #2a2a2a; /* darker for contrast on #d3d8d2 background */
  --text-color-light: #5a5a5a;
  --border-color: #d0d0d0; /* subtle border for images */
  --background-color: #d3d8d2;
  --content-background-color: #fff;
  --link-color: #e6423a;
  --link-hover-color: #d97706; /* darker orange for contrast on white */
  --link-visited-color: #5b4a3b;
  --link-active-color: #0d703f;
}

/* Redefine colors for dark mode - based on DR10 palette */
@media (prefers-color-scheme: dark) {
  :root {
    --text-color: #e0e0e0;
    --text-color-light: #b0b0b0;
    --border-color: #4a4a4a; /* subtle border for images in dark mode */
    --background-color: #1a1a1a;
    --content-background-color: #2d2d2d;
    --link-color: #ff6b6b; /* lighter version of DR10 red #e6423a */
    --link-hover-color: #f1b73a; /* DR10 yellow-orange */
    --link-visited-color: #a89585; /* lighter version of DR10 dark brown #5b4a3b, adjusted for WCAG AA contrast */
    --link-active-color: #2db366; /* lighter version of DR10 green #0d703f */
  }
}

/* === RESETS & BASE STYLES === */

/* Box sizing rules */
*, *::before, *::after {
  box-sizing: border-box;
}

/* Prevent font size inflation */
html {
  -moz-text-size-adjust: none;
  -webkit-text-size-adjust: none;
  text-size-adjust: none;
}

/* Remove default margin in favour of better control in authored CSS */
body, h1, h2, h3, h4, p,
figure, blockquote, dl, dd, section {
  margin-block-end: 0;
}

/* Remove list styles on ul, ol elements with a list role */
ul[role='list'], ol[role='list'] {
  list-style: none;
}

/* Take up the entire height of the viewport */
body {
  min-height: 100vh;
  margin: 0; 
  padding: 0;
  font-family: var(--font-family);
  font-size: var(--text-size);
  line-height: var(--line-height);
  letter-spacing: var(--letter-spacing-loose);
  color: var(--text-color);
  background-color: var(--background-color);
}

/* Make images easier to work with */
img, picture {
  max-width: 100%;
  display: block;
}

/* Inherit fonts for inputs and buttons */
input, button, textarea, select {
  font-family: inherit;
  font-size: inherit;
}

/* Make sure textareas without a rows attribute are not tiny */
textarea:not([rows]) {
  min-height: 10em;
}

/* Anything that has been anchored to should have extra scroll margin */
:target {
  scroll-margin-block: var(--spacing-ex);
}

/* === LAYOUT & STRUCTURE === */

/* Main layout containers */
body>header, body>main, body>footer {
  margin: 0 auto;
  padding: var(--gutter);
  max-width: var(--max-width);
  background-color: var(--content-background-color);
}

body>footer {
  padding-top: 0;
}

/* Header layout with hgroup and navigation */
header {
  display: flex;
  justify-content: space-between;
  align-items: baseline;
  flex-wrap: wrap;
  gap: var(--spacing-sm);
}

/* Article grid layout */
article {
  display: grid;
  grid-template-columns: 1fr 2fr;
  grid-template-areas: 
    "a a"
    "b c";
  gap: 0 var(--gutter);
  margin: 0;
  padding-bottom: var(--spacing-lg);
}

/* Article grid areas */
article header {
  grid-area: a;
}

article section {
  grid-area: c;
  min-width: 0;
}

article footer {
  grid-area: b;
}

/* Single column responsive layout */
/* Note: Cannot use var(--breakpoint-single-column) in media query, so value is hardcoded here */
@media all and (max-width: 54rem) {
  article {
    grid-template-columns: 1fr;
    grid-template-areas: 
      "a"
      "b"
      "c";
  }
  
  /* Stack header elements vertically on mobile */
  header {
    flex-direction: column;
    align-items: flex-start;
  }
}

/* === NAVIGATION === */

/* Navigation layout */
nav ul {
  list-style: none;
  margin: 0;
  padding: 0;
  display: flex;
  gap: var(--spacing-md);
  flex-wrap: wrap;
}

nav li {
  margin: 0;
}

/* Navigation typography and colors */
nav a {
  font-size: var(--font-size-xxs);
  line-height: var(--line-height-xxs);
  text-decoration: none;
  color: var(--link-color);
  transition: color 0.3s ease;
}

nav a:hover {
  color: var(--link-hover-color);
}

nav a:visited {
  color: var(--link-visited-color);
}

nav a[aria-current="page"] {
  color: var(--link-color);
}

/* Post navigation layout */
nav.post-navigation {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

/* Pagination layout */
nav.pagination {
  display: flex;
  align-items: center;
}

/* Navigation prev/next positioning */
nav.post-navigation a.prev,
nav.pagination a.prev {
  margin-right: auto;
}

nav.post-navigation a.next,
nav.pagination a.next {
  margin-left: auto;
}

/* === TYPOGRAPHY === */

/* Headings */
h1, h2, h3, h4 {
  margin: var(--spacing-md) 0 0.25rem 0;
  text-wrap: balance;
}

/* Unified heading styles */
h1, h2, h3, h4, h5, h6 {
  letter-spacing: var(--letter-spacing-tight);
}

h1 {
  font-size: var(--font-size-2xl);
  line-height: var(--line-height-2xl);
  font-weight: var(--font-weight-bold);
}

h2 {
  font-size: var(--font-size-xl);
  line-height: var(--line-height-xl);
  font-weight: var(--font-weight-bold);
}

h3 {
  font-size: var(--font-size-lg);
  line-height: var(--line-height-lg);
  font-weight: var(--font-weight-bold);
}

h4 {
  font-size: var(--font-size-md);
  line-height: var(--line-height-md);
  font-weight: var(--font-weight-bold);
}

h5 {
  font-size: var(--font-size-sm);
  line-height: var(--line-height-sm);
  font-weight: var(--font-weight-bold);
}

h6 {
  font-size: var(--font-size-xs);
  line-height: var(--line-height-xs);
  font-weight: var(--font-weight-black);
}

/* Hgroup layout and typography */
hgroup {
  display: flex;
  align-items: baseline;
  gap: var(--spacing-sm);
  flex-wrap: wrap;
}

hgroup h1 {
  font-size: var(--font-size-3xl);
  line-height: var(--line-height-3xl);
  font-weight: var(--font-weight-thin);
  margin: 0;
}

hgroup p {
  margin: 0;
  font-size: var(--font-size-xs);
  line-height: var(--line-height-xs);
  font-style: italic;
}

header h1 + p {
  margin-top: 0rem;
}

/* Article headings */
article h1 {
  margin: 0;
  font-weight: var(--font-weight-semibold);
}

/* Main content headings */
main > h1 {
  margin: 0;
}

/* Paragraphs */
p {
  margin: var(--spacing-sm) 0;
}

/* Horizontal rules */
hr {
  border: 0;
  border-top: 1px solid var(--text-color-light);
  margin: var(--spacing-lg) 0;
  opacity: 0.5;
}

/* Form elements typography */
button, input, label {
  line-height: var(--line-height-tight);
}

/* License typography and colors */
.license,
footer p {
  font-size: var(--font-size-xxs);
  line-height: var(--line-height-xxs);
  color: var(--link-visited-color);
}

.license {
  text-align: right;
  font-style: italic;
  margin: 0;
  font-weight: 300;
}

/* Code blocks */
code, pre {
  font-size: var(--font-size-xxs);
  line-height: var(--line-height-xs);
}

pre {
  overflow-x: auto;
  max-width: 100%;
  min-width: 0;
  padding: var(--spacing-sm);
  background-color: var(--background-color);
  border-radius: 0.25rem;
}

pre code {
  font-size: inherit;
}

/* === LINKS === */

/* Base link styles */
a {
  text-decoration: none;
  color: var(--link-color);
  transition: color 0.3s ease;
}

a:hover,
a:focus {
  color: var(--link-hover-color);
  text-decoration: underline;
}

a:visited {
  color: var(--link-visited-color);
}

a:active {
  color: var(--link-active-color);
}

/* Unclassed links use current color */
a:not([class]) {
  text-decoration-skip-ink: auto;
  color: currentColor;
}

/* Content links always underlined (articles and full-width pages) */
article a,
main[data-tags*="page"] a {
  text-decoration: underline;
}

/* Article h1 links exception */
article h1 a {
  text-decoration: none;
}

article h1 a:hover {
  text-decoration: underline;
}

/* Links in article sections */
article section a:hover {
  color: var(--link-hover-color);
}

/* Hgroup links keep link-color even when visited */
hgroup h1 a:visited,
hgroup p {
  color: var(--link-color);
}

/* === COMPONENTS === */

/* Link items */
article.link-item {
  margin-bottom: 0;
  color: var(--link-visited-color);
}

article.link-item section {
  margin: 0;
  padding: 0;
}

article.link-item p {
  margin: 0;
}

/* End-of-post square */
article:not(.link-item) section::after,
main[data-tags*="page"]::after {
  content: "";
  display: block;
  width: 0.5rem;
  height: 0.5rem;
  background-color: var(--text-color-light);
  margin: var(--spacing-sm) 0 0 0;
}

/* Position square in right column for portfolio detail pages */
article.portfolio-detail section::after {
  grid-column: 2;
}

/* Portfolio Detail Styles */
article.portfolio-detail section {
  /* Span full width of the parent grid, taking over areas b and c */
  grid-column: 1 / -1;
  
  /* Re-establish the parent's grid inside this section */
  display: grid;
  grid-template-columns: 1fr 2fr;
  gap: 0 var(--gutter);
}

article.portfolio-detail section > * {
  /* All standard content (text, lists, etc.) goes to the right column */
  grid-column: 2;
}

/* Images (and their wrapper paragraphs) span the full width */
article.portfolio-detail section > p:has(> img:only-child),
article.portfolio-detail section > figure,
article.portfolio-detail section > img {
  grid-column: 1 / -1;
  margin: var(--spacing-lg) 0;
}

article.portfolio-detail section > p:has(> img:only-child) img,
article.portfolio-detail section > figure img {
  width: 100%;
  height: auto;
  border: 1px solid var(--border-color);
}

/* Captions align with the text column */
article.portfolio-detail section > figure figcaption {
    margin-top: var(--spacing-xs);
    font-size: var(--font-size-xs);
    line-height: var(--line-height-xs);
    color: var(--text-color-light);
    font-style: italic;
    /* This makes the caption align with the text column (2fr) */
    /* Figure spans full width (3fr + gap), text column starts at (1fr + gap) */
    /* So padding = (1fr / (3fr + gap)) * 100% + gap = ((100% - gap) / 3) + gap */
    padding-left: calc(((100% - var(--gutter)) / 3) + var(--gutter)); 
}

/* Mobile adjustments for portfolio detail */
@media all and (max-width: 54rem) {
  article.portfolio-detail section {
    grid-template-columns: 1fr;
  }
  
  article.portfolio-detail section > * {
    grid-column: 1;
  }
  
  article.portfolio-detail section > figure figcaption {
    padding-left: 0;
  }
}

/* Portfolio Grid */
ul.portfolio-grid {
  display: grid;
  grid-template-columns: 1fr;
  gap: var(--gutter);
  padding: 0;
  list-style: none;
}

@media (min-width: 40rem) {
  ul.portfolio-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (min-width: 60rem) {
  ul.portfolio-grid {
    grid-template-columns: repeat(3, 1fr);
  }
}

/* Portfolio Item Override */
article.portfolio-item {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-xs);
  padding-bottom: 0;
  margin-bottom: var(--spacing-lg);
}

article.portfolio-item img {
  width: 100%;
  height: auto;
  aspect-ratio: 16/9; /* Optional: Keeps images uniform */
  object-fit: cover;
}

article.portfolio-item p {
  font-size: var(--font-size-sm);
  font-weight: var(--font-weight-semibold);
  line-height: var(--line-height-sm);
  margin: 0;
}

article.portfolio-item p.portfolio-item-description {
  font-size: var(--font-size-xs);
  font-weight: normal;
  line-height: var(--line-height-xs);
  color: var(--text-color-light);
  margin-top: var(--spacing-xs);
}

/* Portrait Grid Container */
article.portfolio-detail section > .portrait-grid {
  grid-column: 1 / -1; /* Span full width of the article */
  display: grid;
  grid-template-columns: repeat(1, 1fr); /* Mobile: 1 col */
  gap: var(--gutter);
  margin: var(--spacing-lg) 0;
}

@media (min-width: 40rem) {
  article.portfolio-detail section > .portrait-grid {
    grid-template-columns: repeat(2, 1fr); /* Tablet: 2 cols */
  }
}

@media (min-width: 60rem) {
  article.portfolio-detail section > .portrait-grid {
    grid-template-columns: repeat(3, 1fr); /* Desktop: 3 cols */
  }
}

/* Ensure figures inside the grid behave */
article.portfolio-detail section > .portrait-grid figure {
  margin: 0;
  grid-column: auto; /* Reset grid-column from the generic figure rule */
}

article.portfolio-detail section > .portrait-grid figure img {
  width: 100%;
  height: auto;
}

article.portfolio-detail section > .portrait-grid figure figcaption {
  margin-top: var(--spacing-xs);
  font-size: var(--font-size-xs);
  line-height: var(--line-height-xs);
  color: var(--text-color-light);
  font-style: italic;
  padding-left: 0; /* Reset padding since these are in narrow columns */
}

/* === UTILITIES === */

/* Screen reader only */
.sr-only, header a.skip {
  position: absolute;
  left: -10000rem;
  top: auto;
  width: 1px;
  height: 1px;
  overflow: hidden;
}

/* Skip link focus state */
header a.skip:focus {
  position: fixed;
  left: 0;
  top: 0;
  width: auto;
  height: auto;
  background-color: var(--content-background-color);
  padding: 1rem;
  z-index: 100;
}

/* === OG IMAGE PREVIEW PAGE === */
/* Styles for the OG image preview page (dev tool) */

.preview-container {
  max-width: var(--max-width);
  margin: var(--spacing-lg) auto;
  padding: 0 var(--gutter);
}

.preview-info {
  margin-bottom: var(--spacing-lg);
  padding: var(--spacing-md);
  background: var(--content-background-color);
  border: 1px solid var(--text-color-light);
}

.preview-section {
  margin: var(--spacing-lg) 0;
}

.preview-section h2 {
  font-size: var(--font-size-lg);
  margin-bottom: var(--spacing-md);
  color: var(--text-color);
}

.og-preview-wrapper {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-lg);
  margin: var(--spacing-lg) 0;
}

.og-preview-item {
  border: 1px solid var(--text-color-light);
  padding: var(--spacing-md);
  background: var(--content-background-color);
}

.og-preview-item h3 {
  font-size: var(--font-size-md);
  margin-bottom: var(--spacing-sm);
  color: var(--text-color);
}

/* Scale down the 1200x630 OG image to fit in browser */
.og-preview-scaled {
  transform: scale(0.5);
  transform-origin: top left;
  width: 1200px;
  height: 630px;
}

.og-preview-container {
  width: 600px;
  height: 315px;
  overflow: hidden;
  border: 1px solid var(--text-color-light);
  background: white;
}

.og-preview-content {
  width: 1200px;
  height: 630px;
}

.og-images-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 2rem;
  margin: var(--spacing-lg) 0;
}

.og-images-grid-item {
  border: 1px solid var(--text-color-light);
  padding: 1rem;
  background: var(--content-background-color);
}

.og-images-grid-item img {
  width: 100%;
  height: auto;
  display: block;
  margin-bottom: 0.5rem;
}

.og-images-grid-item code {
  font-size: var(--font-size-xxs);
  word-break: break-all;
}

/* === OG IMAGE RENDERED STYLES === */
/* Styles for OG images rendered via renderOgImage shortcode (scoped to .og-image-rendered) */

.og-image-rendered {
  /* CSS custom properties from main stylesheet (scoped) */
  --gutter: 2rem;
  --max-width: 66rem;
  --breakpoint-single-column: 54rem;
  --font-family: system-ui, sans-serif;
  --text-size: 16px;
  --line-height: 1.5;
  --font-size-xxs: 0.875rem;
  --line-height-xxs: 1.715;
  --font-size-xs: 1rem;
  --line-height-xs: 1.5;
  --font-size-sm: 1.125rem;
  --line-height-sm: 1.3334;
  --font-size-md: 1.25rem;
  --line-height-md: 1.2;
  --font-size-lg: 1.5rem;
  --line-height-lg: 1;
  --font-size-xl: 2rem;
  --line-height-xl: 1;
  --font-size-2xl: 2.5rem;
  --line-height-2xl: 1.2;
  --font-size-3xl: 4rem;
  --line-height-3xl: 1;
  --line-height-tight: 1.1;
  --font-weight-thin: 100;
  --font-weight-semibold: 600;
  --font-weight-bold: 700;
  --font-weight-black: 900;
  --letter-spacing-tight: -0.025em;
  --letter-spacing-normal: normal;
  --letter-spacing-loose: 0.025em;
  --spacing-xs: 0.5rem;
  --spacing-sm: 1rem;
  --spacing-md: 1.25rem;
  --spacing-lg: 2rem;
  --spacing-xl: 2.25rem;
  --spacing-ex: 5ex;
  
  /* Force light theme for OG images */
  --text-color: #2a2a2a;
  --text-color-light: #5a5a5a;
  --background-color: #d3d8d2;
  --content-background-color: #fff;
  --link-color: #e6423a;
  --link-hover-color: #d97706;
  --link-visited-color: #5b4a3b;
  --link-active-color: #0d703f;
  
  box-sizing: border-box;
  margin: 0;
  padding: 0;
  width: 1200px;
  height: 630px;
  font-family: var(--font-family);
  font-size: 1.5rem;
  line-height: var(--line-height);
  letter-spacing: var(--letter-spacing-loose);
  color: var(--text-color);
  background-color: var(--background-color);
  display: flex;
  justify-content: center;
  align-items: center;
}

.og-image-rendered * {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

.og-image-rendered a {
  color: inherit;
  text-decoration: none;
}

.og-image-rendered .og-content {
  width: 100%;
  background-color: var(--content-background-color);
  padding: 4rem;
  display: flex;
  flex-direction: column;
  gap: var(--spacing-sm);
}

.og-image-rendered .og-hgroup {
  display: flex;
  align-items: baseline;
  gap: var(--spacing-sm);
  flex-wrap: wrap;
}

.og-image-rendered .og-hgroup h1 {
  font-size: 6rem;
  line-height: var(--line-height-3xl);
  font-weight: var(--font-weight-thin);
  letter-spacing: var(--letter-spacing-tight);
  color: var(--link-color);
}

.og-image-rendered .og-hgroup h1 a {
  color: var(--link-color) !important;
  text-decoration: none;
}

.og-image-rendered .og-hgroup p {
  font-size: 1.5rem;
  line-height: var(--line-height-xs);
  font-style: italic;
  color: var(--link-color);
}

.og-image-rendered .og-title {
  font-size: 3.5rem;
  line-height: var(--line-height-2xl);
  font-weight: var(--font-weight-semibold);
  letter-spacing: var(--letter-spacing-tight);
  text-wrap: balance;
}

.og-image-rendered .og-description {
  font-size: 1.75rem;
  max-width: 90%;
}

.og-image-rendered .og-date {
  font-size: 1.5rem;
  font-style: italic;
}
